var shioharaApp=angular.module("shioharaApp",["ui.router","vecchioOauth"]);
shioharaApp.config(["$stateProvider","$urlRouterProvider","TokenProvider",function(a,c,g){g.extendConfig({clientId:"b0ec29dd6e0c6bd98b37fee1799dc0a8",redirectUri:"http://localhost:8080/oauth2callback.html",scopes:["https://www.googleapis.com/auth/userinfo.email"]});c.otherwise("/content");a.state("oauth2",{url:"/oauth2",templateUrl:"template/oauth2.html",controller:"ShOAuth2Ctrl",data:{pageTitle:"OAuth2 | Viglet Shiohara"}}).state("content",{url:"/content",templateUrl:"template/content.html",controller:"ShContentCtrl",
data:{pageTitle:"Content | Viglet Shiohara"}}).state("content.post-type-select",{url:"/post/type/select",templateUrl:"template/post/type/select.html",controller:"ShPostTypeSelectCtrl",data:{pageTitle:"Post Type Select | Viglet Shiohara"}}).state("content.post-type-editor",{url:"/post/type/select",templateUrl:"template/post/type/editor.html",controller:"ShPostTypeSelectCtrl",data:{pageTitle:"Post Type Editor | Viglet Shiohara"}}).state("content.post-type-item",{url:"/post/type/:postTypeId",templateUrl:"template/post/type/item.html",
controller:"ShPostTypeItemCtrl",data:{pageTitle:"Post Type Editor | Viglet Shiohara"}}).state("content.post-type-item.attribute",{url:"/attrib/:postTypeAttrId",templateUrl:"template/post/type/attribute.html",controller:"ShPostTypeAttrCtrl",data:{pageTitle:"Post Type Editor | Viglet Shiohara"}}).state("content.post-type-item.post-item-new",{url:"/post/new",templateUrl:"template/post/item.html",controller:"ShPostNewCtrl",data:{pageTitle:"Post New | Viglet Shiohara"}}).state("content.post-type-item.post-item",
{url:"/post/:postId",templateUrl:"template/post/item.html",controller:"ShPostEditCtrl",data:{pageTitle:"Post New | Viglet Shiohara"}}).state("post-item-form",{url:"/post/type/:postTypeId/post/form",templateUrl:"template/post/form.html",controller:"ShPostFormCtrl"})}]);
shioharaApp.controller("ShContentCtrl",["$scope","$http","$window","$state","$rootScope","Token",function(a,c,g,f,d,e){a.accessToken=e.get();a.shUser=null;a.shPosts=null;d.$state=f;a.$evalAsync(c.get(jp_domain+"/api/user/2?access_token\x3d"+a.accessToken).then(function(b){a.shUser=b.data}));a.$evalAsync(c.get(jp_domain+"/api/post").then(function(b){a.shPosts=b.data}))}]);
shioharaApp.controller("ShPostFormCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope",function(a,c,g,f,d,e){a.postTypeAttrId=f.postTypeAttrId;a.shPostTypeItem=angular.copy(a.shPostType)}]);
shioharaApp.controller("ShPostTypeAttrCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope",function(a,c,g,f,d,e){a.postTypeAttrId=f.postTypeAttrId;a.shPostTypeAttr=null;e.$state=d;a.$evalAsync(c.get(jp_domain+"/api/post/type/attr/"+a.postTypeAttrId).then(function(b){a.shPostTypeAttr=b.data}));a.postTypeAttrSave=function(){var b=angular.toJson(a.shPostTypeAttr);c.put(jp_domain+"/api/post/type/attr/"+a.postTypeAttrId,b).then(function(a,b,c,e){d.go("content.post-type-item")},function(a,
b,c,e){d.go("content.post-type-item")})}}]);shioharaApp.controller("ShPostTypeSelectCtrl",["$scope","$http","$window","$state","$rootScope",function(a,c,g,f,d){a.shPostTypes=null;d.$state=f;a.$evalAsync(c.get(jp_domain+"/api/post/type").then(function(c){a.shPostTypes=c.data}))}]);
shioharaApp.controller("ShPostTypeItemCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope",function(a,c,g,f,d,e){a.postTypeId=f.postTypeId;a.shPostType=null;a.shWidgets=null;e.$state=d;a.$evalAsync(c.get(jp_domain+"/api/post/type/"+a.postTypeId).then(function(b){a.shPostType=b.data;a.shPostNewItem=angular.copy(a.shPostType);for(b=0;b<a.shPostNewItem.shPostTypeAttrs.length;b++)a.shPostNewItem.shPostTypeAttrs[b].value="Novo Valor"+b}));a.$evalAsync(c.get(jp_domain+"/api/widget").then(function(b){a.shWidgets=
b.data}));a.postTypeSave=function(){var b=angular.toJson(a.shPostType);c.put(jp_domain+"/api/post/type/"+a.postTypeId,b).then(function(a,b,c,e){d.go("content.post-type-item")},function(a,b,c,e){d.go("content.post-type-item")})}}]);
shioharaApp.controller("ShPostNewCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope",function(a,c,g,f,d,e){a.postTypeId=f.postTypeId;a.shPost=null;a.$evalAsync(c.get(jp_domain+"/api/post/type/"+a.postTypeId+"/post/model").then(function(b){a.shPost=b.data}));a.postEditForm="template/post/form.html";a.postSave=function(){var b=angular.toJson(a.shPost);c.post(jp_domain+"/api/post/"+a.postTypeId,b).then(function(a,b,c,e){d.go("content")},function(a,b,c,e){d.go("content")})}}]);
shioharaApp.controller("ShPostEditCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope",function(a,c,g,f,d,e){a.postId=f.postId;a.shPost=null;a.$evalAsync(c.get(jp_domain+"/api/post/"+a.postId).then(function(b){a.shPost=b.data}));a.postEditForm="template/post/form.html";a.postSave=function(){var b=angular.toJson(a.shPost);c.put(jp_domain+"/api/post/"+a.postId,b).then(function(a,b,c,e){d.go("content")},function(a,b,c,e){d.go("content")})}}]);
shioharaApp.controller("ShOAuth2Ctrl",["$scope","$http","$window","$state","$rootScope","Token",function(a,c,g,f,d,e){a.accessToken=e.get();a.authenticate=function(){e.getTokenByPopup(a.askApproval?{approval_prompt:"force"}:{}).then(function(b){e.verifyAsync(b.access_token).then(function(c){d.$apply(function(){a.accessToken=b.access_token;a.expiresIn=b.expires_in;e.set(b.access_token)})},function(){alert("Failed to verify token.")})},function(){alert("Failed to get token from popup.")})}}]);
shioharaApp.controller("ShSiteListCtrl",["$scope","$http","$window","$state","$rootScope",function(a,c,g,f,d){a.shSites=null;d.$state=f;a.$evalAsync(c.get(jp_domain+"/api/site").then(function(c){a.shSites=c.data}))}]);