var shioharaApp=angular.module("shioharaApp","ngCookies ngResource ngAnimate ngSanitize ui.router ui.bootstrap pascalprecht.translate vecchioOauth".split(" "));
shioharaApp.config(["$stateProvider","$urlRouterProvider","TokenProvider",function(a,b,f){f.extendConfig({clientId:"b0ec29dd6e0c6bd98b37fee1799dc0a8",redirectUri:"http://localhost:8080/oauth2callback.html",scopes:["https://www.googleapis.com/auth/userinfo.email"]});b.otherwise("/content");a.state("oauth2",{url:"/oauth2",templateUrl:"template/oauth2.html",controller:"ShOAuth2Ctrl",data:{pageTitle:"OAuth2 | Viglet Shiohara"}}).state("content",{url:"/content",templateUrl:"template/content.html",controller:"ShContentCtrl",
data:{pageTitle:"Content | Viglet Shiohara"}}).state("content.post-type-select",{url:"/post/type/select",templateUrl:"template/post/type/select.html",controller:"ShPostTypeSelectCtrl",data:{pageTitle:"Post Type Select | Viglet Shiohara"}}).state("content.post-type-editor",{url:"/post/type/select",templateUrl:"template/post/type/editor.html",controller:"ShPostTypeSelectCtrl",data:{pageTitle:"Post Type Editor | Viglet Shiohara"}}).state("content.post-type-item",{url:"/post/type/:postTypeId",templateUrl:"template/post/type/item.html",
controller:"ShPostTypeItemCtrl",data:{pageTitle:"Post Type Editor | Viglet Shiohara"}}).state("content.post-type-item.attribute",{url:"/attrib/:postTypeAttrId",templateUrl:"template/post/type/attribute.html",controller:"ShPostTypeAttrCtrl",data:{pageTitle:"Post Type Editor | Viglet Shiohara"}}).state("content.post-type-item.post-item-new",{url:"/post/new",templateUrl:"template/post/item.html",controller:"ShPostNewCtrl",data:{pageTitle:"Post New | Viglet Shiohara"}}).state("content.post-type-item.post-item",
{url:"/post/:postId",templateUrl:"template/post/item.html",controller:"ShPostEditCtrl",data:{pageTitle:"Post New | Viglet Shiohara"}}).state("post-item-form",{url:"/post/type/:postTypeId/post/form",templateUrl:"template/post/form.html",controller:"ShPostFormCtrl"})}]);
shioharaApp.service("shAPIServerService",["$http","$location","$cookies",function(a,b,f){var d=b.protocol(),e=b.host();b=b.port();var c=d+"://"+e+":"+b+"/api";console.log(c);this.get=function(){if(null!=f.get("shAPIServer"))return f.get("shAPIServer");a({method:"GET",url:c}).then(function(a){f.put("shAPIServer",c)},function(a){f.put("shAPIServer","http://localhost:2710/api")});return c}}]);
shioharaApp.controller("ShContentCtrl",["$scope","$http","$window","$state","$rootScope","Token","shUserResource","shPostResource",function(a,b,f,d,e,c,g,h){a.accessToken=c.get();a.shUser=null;a.shPosts=null;e.$state=d;a.shUser=g.get({id:2,access_token:a.accessToken});a.shPosts=h.query()}]);shioharaApp.controller("ShPostFormCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope",function(a,b,f,d,e,c){a.postTypeAttrId=d.postTypeAttrId;a.shPostTypeItem=angular.copy(a.shPostType)}]);
shioharaApp.controller("ShPostTypeAttrCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope","shPostTypeAttrResource",function(a,b,f,d,e,c,g){a.postTypeAttrId=d.postTypeAttrId;a.shPostTypeAttr=g.get({id:a.postTypeAttrId});c.$state=e;a.postTypeAttrSave=function(){a.shshPostTypeAttrPost.$update(function(){e.go("content.post-type-item")})}}]);
shioharaApp.controller("ShPostTypeSelectCtrl",["$scope","$http","$window","$state","$rootScope","shPostTypeResource",function(a,b,f,d,e,c){e.$state=d;a.shPostTypes=c.query()}]);
shioharaApp.controller("ShPostTypeItemCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope","shWidgetResource","shPostTypeResource",function(a,b,f,d,e,c,g,h){a.postTypeId=d.postTypeId;a.shPostType=null;a.shWidgets=g.query();c.$state=e;a.shPostType=h.get({id:a.postTypeId},function(b){a.shPostNewItem=angular.copy(a.shPostType);for(b=0;b<a.shPostNewItem.shPostTypeAttrs.length;b++)a.shPostNewItem.shPostTypeAttrs[b].value="Novo Valor"+b});a.postTypeSave=function(){a.shPostType.$update(function(){e.go("content.post-type-item")})}}]);
shioharaApp.factory("shPostTypeAttrResource",["$resource","shAPIServerService",function(a,b){return a(b.get().concat("/post/type/attr/:id"),{id:"@id"},{update:{method:"PUT"}})}]);shioharaApp.factory("shPostTypeResource",["$resource","shAPIServerService",function(a,b){return a(b.get().concat("/post/type/:id"),{id:"@id"},{update:{method:"PUT"}})}]);
shioharaApp.controller("ShPostNewCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope","shAPIServerService","shPostResource",function(a,b,f,d,e,c,g,h){a.postTypeId=d.postTypeId;a.shPost=null;a.$evalAsync(b.get(g.get().concat("/post/type/"+a.postTypeId+"/post/model")).then(function(b){a.shPost=b.data}));a.postEditForm="template/post/form.html";a.postSave=function(){delete a.shPost.id;h.save(a.shPost)}}]);
shioharaApp.factory("shPostResource",["$resource","shAPIServerService",function(a,b){return a(b.get().concat("/post/:id"),{id:"@id"},{update:{method:"PUT"}})}]);shioharaApp.controller("ShPostEditCtrl",["$scope","$http","$window","$stateParams","$state","$rootScope","shPostResource",function(a,b,f,d,e,c,g){a.postId=d.postId;a.shPost=g.get({id:a.postId});a.postEditForm="template/post/form.html";a.postSave=function(){a.shPost.$update(function(){e.go("content")})}}]);
shioharaApp.factory("shWidgetResource",["$resource","shAPIServerService",function(a,b){return a(b.get().concat("/widget/:id"),{id:"@id"},{update:{method:"PUT"}})}]);
shioharaApp.controller("ShOAuth2Ctrl",["$scope","$http","$window","$state","$rootScope","Token",function(a,b,f,d,e,c){a.accessToken=c.get();a.authenticate=function(){c.getTokenByPopup(a.askApproval?{approval_prompt:"force"}:{}).then(function(b){c.verifyAsync(b.access_token).then(function(d){e.$apply(function(){a.accessToken=b.access_token;a.expiresIn=b.expires_in;c.set(b.access_token)})},function(){alert("Failed to verify token.")})},function(){alert("Failed to get token from popup.")})}}]);
shioharaApp.factory("shUserResource",["$resource","shAPIServerService",function(a,b){return a(b.get().concat("/user/:id"),{id:"@id"},{update:{method:"PUT"}})}]);shioharaApp.controller("ShSiteListCtrl",["$scope","$http","$window","$state","$rootScope","shSiteResource",function(a,b,f,d,e,c){e.$state=d;a.shSites=c.query()}]);shioharaApp.factory("shSiteResource",["$resource","shAPIServerService",function(a,b){return a(b.get().concat("/site/:id"),{id:"@id"},{update:{method:"PUT"}})}]);